YUI.add("moodle-atto_wordcount-button",function(n,t){var r=0;n.namespace("M.atto_wordcount").Button=n.Base.create("button",n.M.editor_atto.EditorPlugin,[],{block:0,updateRate:200,counterid:null,spacer:/(<\/(?!a>|b>|del>|em>|i>|ins>|s>|small>|strong>|sub>|sup>|u>)\w+>|<br> | <br\s*\/>)/g,mediaTags:/(<(audio|video)).*(<\/(audio|video)>)/gm,counter:new RegExp("[\\p{Z}\\p{Cc}—–]+","gu"),initializer:function(){var t,e,i=this.get("host"),o=i._wrapper;this.counterid=i.get("elementid")+"-word-count",this.counterid=this.counterid.replace(":","-"),this.counterElement=n.Node.create('<span class="badge badge-light" id="'+this.counterid+'">0</span>'),o.appendChild(n.Node.create('<div class="'+this.toolbar.getAttribute("class")+' editor_atto_toolbar_bottom p-0 d-flex"><div class="d-inline-flex p-1"><strong>'+M.util.get_string("words","atto_wordcount")+':&#160;</strong><span id="'+this.counterid+'">0</span></div></div>')),this.wordlimit=this.get("wordlimits")[r],this.wordlimit&&((t=document.createElement("span")).innerHTML="/",document.getElementById(this.counterid).parentNode.appendChild(t),(e=document.createElement("span")).innerHTML=this.wordlimit,document.getElementById(this.counterid).parentNode.appendChild(e)),r+=1,this._count(i.get("editor")),this.get("host").on("pluginsloaded",function(){this.get("host").on("atto:selectionchanged",this._count,this)},this)},_count:function(e){var i=this;i.block||(i.block=1,setTimeout(function(){var t=i._getCount(e);n.one("#"+i.counterid).set("text",t),i.wordlimit&&(i.wordlimit-t<0?(n.one("#"+i.counterid).addClass("danger"),n.one("#"+i.counterid).removeClass("warning")):(i.wordlimit-t<10?n.one("#"+i.counterid).addClass("warning"):n.one("#"+i.counterid).removeClass("warning"),n.one("#"+i.counterid).removeClass("danger"))),setTimeout(function(){i.block=0},i.updateRate)}))},_getCount:function(){var t,e=0,i=this.get("host").getCleanHTML();return i&&(t=(t=(i=(i=(i=i.replace(this.spacer,"$1 ")).replace(/<.[^<>]*?>/g,"")).replace(/&nbsp;|&#160;/gi," ")).split(this.counter,-1)).filter(function(t){return""!=t.trim()}))&&(e=t.length),e}},{ATTRS:{wordlimits:{value:[0]}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});